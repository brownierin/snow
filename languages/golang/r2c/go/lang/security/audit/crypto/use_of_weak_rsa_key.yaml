rules:
- id: use-of-weak-rsa-key
  message: Weak RSA keys may be susceptible to brute force attacks given enough time and computing power.  Current guidance indicates that RSA keys should be 2048 bits or longer to render brute force attacks impractical.
  languages: [go]
  severity: WARNING
  metadata:
    cwe: 'CWE-326: Inadequate Encryption Strength'
    owasp: 'A3: Sensitive Data Exposure'
    source-rule-url: https://github.com/securego/gosec/blob/master/rules/rsa.go
    references:
    - https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#algorithms
    - https://en.wikipedia.org/wiki/Key_size
  patterns:
  - pattern-either:
    - pattern: |
        rsa.GenerateKey(..., $BITS)
    - pattern: |
        rsa.GenerateMultiPrimeKey(..., $BITS)
  - metavariable-comparison:
      comparison: $BITS < 2048
      metavariable: $BITS
