rules:
- id: avoid-ssh-insecure-ignore-host-key
  message: |
    Use of ssh library with disabled host key verification detected. This may permit an attacker to completely subvert encryption and gain access to encrypted contents, including passwords. A successful attacker will be able to inject commands into a terminal session, to modify data in transit, or to steal data.  To implement host key verification, use the 'golang.org/x/crypto/ssh/knownhosts' package.
  metadata:
    cwe: 'CWE-322: Key Exchange without Entity Authentication'
    owasp: 'A3: Sensitive Data Exposure'
    source-rule-url: https://github.com/securego/gosec
    references:
    - https://skarlso.github.io/2019/02/17/go-ssh-with-host-key-verification/
    - https://gist.github.com/Skarlso/34321a230cf0245018288686c9e70b2d
    - https://www.ssh.com/attack/man-in-the-middle
  languages: [go]
  severity: WARNING
  pattern: |-
    ssh.InsecureIgnoreHostKey()
