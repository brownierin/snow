rules:
- id: jwt-go-parse-unverified
  message: |
    Detected the decoding of a JWT token without a verify step.
    The ParseUnverified() method parses the token but doesn't validate the signature. This method should only be used to extract values from a JWT whose signature has already been validated, and should usually be avoided altogether.  To fix, replace use of the ParseUnverified() function with the Parse() function.  The Parse() function will parse, validate, and return the token.
  metadata:
    cwe: 'CWE-345: Insufficient Verification of Data Authenticity'
    owasp: 'A2: Broken Authentication'
    source-rule-url: https://r2c.dev/blog/2020/hardcoded-secrets-unverified-tokens-and-other-common-jwt-mistakes/
    references: 
      - https://www.rfc-editor.org/rfc/rfc8725.html
      - https://developer.okta.com/docs/guides/validate-access-tokens/go/overview/
  languages: [go]
  severity: WARNING
  patterns:
  - pattern-inside: |
      import "github.com/dgrijalva/jwt-go"
      ...
  - pattern: |
      $JWT.ParseUnverified(...)
