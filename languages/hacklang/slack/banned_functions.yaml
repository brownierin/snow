rules:
  - id: slack.hack.open-redirect
    languages: [hack]
    message: Using this function can cause open redirect vulnerabilities!
    fix: >-
      Please use util_internal_redirect instead. If you are determined to implement an
      open redirect please reach out to #triage-prodsec to discuss mitigations.
    patterns:
      - pattern: $FUNC(...)
      - metavariable-regex:
          metavariable: $FUNC
          regex: "(util_redirect|util_redirect_migrate|util_allowed_migrate_redirect)"
    severity: ERROR
