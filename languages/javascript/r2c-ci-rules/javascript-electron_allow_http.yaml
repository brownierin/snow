rules:
- id: contrib.nodejsscan.security_electronjs.electron_allow_http
  patterns:
  - pattern-either:
    - pattern: >
        new BrowserWindow({webPreferences: {allowRunningInsecureContent:
        true}});
    - pattern: |
        var $X = {webPreferences: {allowRunningInsecureContent: true}};
  message: >-
    Application can load content over HTTP and that makes the app vulnerable
    to Man in the middle attacks. `allowRunningInsecureContent` should be configured
    to `false`.
  languages:
  - javascript
  severity: ERROR
  metadata:
    owasp: 'A6: Security Misconfiguration'
    cwe: 'CWE-319: Cleartext Transmission of Sensitive Information'
