rules:
- id: contrib.nodejsscan.eval_yaml_deserialize.yaml_deserialize
  patterns:
  - pattern-inside: |
      require('js-yaml');
      ...
  - pattern: |
      $X.load(...)
  message: >-
    User controlled data in 'yaml.load()' function can result in Remote Code
    Injection. When dealing with user controlled data, it is prefered to use
    format such as JSON instead of YAML. 
  languages:
  - javascript
  severity: ERROR
  metadata:
    owasp: 'A8: Insecure Deserialization'
    cwe: 'CWE-502: Deserialization of Untrusted Data'
